BEGIN {
    _crc_cmpl = 0xffff;
    _crc_initial = 0x0000;

    _CRC16_TABLE[  0] = 0x0000;
    _CRC16_TABLE[  1] = 0x1021;
    _CRC16_TABLE[  2] = 0x2042;
    _CRC16_TABLE[  3] = 0x3063;
    _CRC16_TABLE[  4] = 0x4084;
    _CRC16_TABLE[  5] = 0x50a5;
    _CRC16_TABLE[  6] = 0x60c6;
    _CRC16_TABLE[  7] = 0x70e7;
    _CRC16_TABLE[  8] = 0x8108;
    _CRC16_TABLE[  9] = 0x9129;
    _CRC16_TABLE[ 10] = 0xa14a;
    _CRC16_TABLE[ 11] = 0xb16b;
    _CRC16_TABLE[ 12] = 0xc18c;
    _CRC16_TABLE[ 13] = 0xd1ad;
    _CRC16_TABLE[ 14] = 0xe1ce;
    _CRC16_TABLE[ 15] = 0xf1ef;
    _CRC16_TABLE[ 16] = 0x1231;
    _CRC16_TABLE[ 17] = 0x0210;
    _CRC16_TABLE[ 18] = 0x3273;
    _CRC16_TABLE[ 19] = 0x2252;
    _CRC16_TABLE[ 20] = 0x52b5;
    _CRC16_TABLE[ 21] = 0x4294;
    _CRC16_TABLE[ 22] = 0x72f7;
    _CRC16_TABLE[ 23] = 0x62d6;
    _CRC16_TABLE[ 24] = 0x9339;
    _CRC16_TABLE[ 25] = 0x8318;
    _CRC16_TABLE[ 26] = 0xb37b;
    _CRC16_TABLE[ 27] = 0xa35a;
    _CRC16_TABLE[ 28] = 0xd3bd;
    _CRC16_TABLE[ 29] = 0xc39c;
    _CRC16_TABLE[ 30] = 0xf3ff;
    _CRC16_TABLE[ 31] = 0xe3de;
    _CRC16_TABLE[ 32] = 0x2462;
    _CRC16_TABLE[ 33] = 0x3443;
    _CRC16_TABLE[ 34] = 0x0420;
    _CRC16_TABLE[ 35] = 0x1401;
    _CRC16_TABLE[ 36] = 0x64e6;
    _CRC16_TABLE[ 37] = 0x74c7;
    _CRC16_TABLE[ 38] = 0x44a4;
    _CRC16_TABLE[ 39] = 0x5485;
    _CRC16_TABLE[ 40] = 0xa56a;
    _CRC16_TABLE[ 41] = 0xb54b;
    _CRC16_TABLE[ 42] = 0x8528;
    _CRC16_TABLE[ 43] = 0x9509;
    _CRC16_TABLE[ 44] = 0xe5ee;
    _CRC16_TABLE[ 45] = 0xf5cf;
    _CRC16_TABLE[ 46] = 0xc5ac;
    _CRC16_TABLE[ 47] = 0xd58d;
    _CRC16_TABLE[ 48] = 0x3653;
    _CRC16_TABLE[ 49] = 0x2672;
    _CRC16_TABLE[ 50] = 0x1611;
    _CRC16_TABLE[ 51] = 0x0630;
    _CRC16_TABLE[ 52] = 0x76d7;
    _CRC16_TABLE[ 53] = 0x66f6;
    _CRC16_TABLE[ 54] = 0x5695;
    _CRC16_TABLE[ 55] = 0x46b4;
    _CRC16_TABLE[ 56] = 0xb75b;
    _CRC16_TABLE[ 57] = 0xa77a;
    _CRC16_TABLE[ 58] = 0x9719;
    _CRC16_TABLE[ 59] = 0x8738;
    _CRC16_TABLE[ 60] = 0xf7df;
    _CRC16_TABLE[ 61] = 0xe7fe;
    _CRC16_TABLE[ 62] = 0xd79d;
    _CRC16_TABLE[ 63] = 0xc7bc;
    _CRC16_TABLE[ 64] = 0x48c4;
    _CRC16_TABLE[ 65] = 0x58e5;
    _CRC16_TABLE[ 66] = 0x6886;
    _CRC16_TABLE[ 67] = 0x78a7;
    _CRC16_TABLE[ 68] = 0x0840;
    _CRC16_TABLE[ 69] = 0x1861;
    _CRC16_TABLE[ 70] = 0x2802;
    _CRC16_TABLE[ 71] = 0x3823;
    _CRC16_TABLE[ 72] = 0xc9cc;
    _CRC16_TABLE[ 73] = 0xd9ed;
    _CRC16_TABLE[ 74] = 0xe98e;
    _CRC16_TABLE[ 75] = 0xf9af;
    _CRC16_TABLE[ 76] = 0x8948;
    _CRC16_TABLE[ 77] = 0x9969;
    _CRC16_TABLE[ 78] = 0xa90a;
    _CRC16_TABLE[ 79] = 0xb92b;
    _CRC16_TABLE[ 80] = 0x5af5;
    _CRC16_TABLE[ 81] = 0x4ad4;
    _CRC16_TABLE[ 82] = 0x7ab7;
    _CRC16_TABLE[ 83] = 0x6a96;
    _CRC16_TABLE[ 84] = 0x1a71;
    _CRC16_TABLE[ 85] = 0x0a50;
    _CRC16_TABLE[ 86] = 0x3a33;
    _CRC16_TABLE[ 87] = 0x2a12;
    _CRC16_TABLE[ 88] = 0xdbfd;
    _CRC16_TABLE[ 89] = 0xcbdc;
    _CRC16_TABLE[ 90] = 0xfbbf;
    _CRC16_TABLE[ 91] = 0xeb9e;
    _CRC16_TABLE[ 92] = 0x9b79;
    _CRC16_TABLE[ 93] = 0x8b58;
    _CRC16_TABLE[ 94] = 0xbb3b;
    _CRC16_TABLE[ 95] = 0xab1a;
    _CRC16_TABLE[ 96] = 0x6ca6;
    _CRC16_TABLE[ 97] = 0x7c87;
    _CRC16_TABLE[ 98] = 0x4ce4;
    _CRC16_TABLE[ 99] = 0x5cc5;
    _CRC16_TABLE[100] = 0x2c22;
    _CRC16_TABLE[101] = 0x3c03;
    _CRC16_TABLE[102] = 0x0c60;
    _CRC16_TABLE[103] = 0x1c41;
    _CRC16_TABLE[104] = 0xedae;
    _CRC16_TABLE[105] = 0xfd8f;
    _CRC16_TABLE[106] = 0xcdec;
    _CRC16_TABLE[107] = 0xddcd;
    _CRC16_TABLE[108] = 0xad2a;
    _CRC16_TABLE[109] = 0xbd0b;
    _CRC16_TABLE[110] = 0x8d68;
    _CRC16_TABLE[111] = 0x9d49;
    _CRC16_TABLE[112] = 0x7e97;
    _CRC16_TABLE[113] = 0x6eb6;
    _CRC16_TABLE[114] = 0x5ed5;
    _CRC16_TABLE[115] = 0x4ef4;
    _CRC16_TABLE[116] = 0x3e13;
    _CRC16_TABLE[117] = 0x2e32;
    _CRC16_TABLE[118] = 0x1e51;
    _CRC16_TABLE[119] = 0x0e70;
    _CRC16_TABLE[120] = 0xff9f;
    _CRC16_TABLE[121] = 0xefbe;
    _CRC16_TABLE[122] = 0xdfdd;
    _CRC16_TABLE[123] = 0xcffc;
    _CRC16_TABLE[124] = 0xbf1b;
    _CRC16_TABLE[125] = 0xaf3a;
    _CRC16_TABLE[126] = 0x9f59;
    _CRC16_TABLE[127] = 0x8f78;
    _CRC16_TABLE[128] = 0x9188;
    _CRC16_TABLE[129] = 0x81a9;
    _CRC16_TABLE[130] = 0xb1ca;
    _CRC16_TABLE[131] = 0xa1eb;
    _CRC16_TABLE[132] = 0xd10c;
    _CRC16_TABLE[133] = 0xc12d;
    _CRC16_TABLE[134] = 0xf14e;
    _CRC16_TABLE[135] = 0xe16f;
    _CRC16_TABLE[136] = 0x1080;
    _CRC16_TABLE[137] = 0x00a1;
    _CRC16_TABLE[138] = 0x30c2;
    _CRC16_TABLE[139] = 0x20e3;
    _CRC16_TABLE[140] = 0x5004;
    _CRC16_TABLE[141] = 0x4025;
    _CRC16_TABLE[142] = 0x7046;
    _CRC16_TABLE[143] = 0x6067;
    _CRC16_TABLE[144] = 0x83b9;
    _CRC16_TABLE[145] = 0x9398;
    _CRC16_TABLE[146] = 0xa3fb;
    _CRC16_TABLE[147] = 0xb3da;
    _CRC16_TABLE[148] = 0xc33d;
    _CRC16_TABLE[149] = 0xd31c;
    _CRC16_TABLE[150] = 0xe37f;
    _CRC16_TABLE[151] = 0xf35e;
    _CRC16_TABLE[152] = 0x02b1;
    _CRC16_TABLE[153] = 0x1290;
    _CRC16_TABLE[154] = 0x22f3;
    _CRC16_TABLE[155] = 0x32d2;
    _CRC16_TABLE[156] = 0x4235;
    _CRC16_TABLE[157] = 0x5214;
    _CRC16_TABLE[158] = 0x6277;
    _CRC16_TABLE[159] = 0x7256;
    _CRC16_TABLE[160] = 0xb5ea;
    _CRC16_TABLE[161] = 0xa5cb;
    _CRC16_TABLE[162] = 0x95a8;
    _CRC16_TABLE[163] = 0x8589;
    _CRC16_TABLE[164] = 0xf56e;
    _CRC16_TABLE[165] = 0xe54f;
    _CRC16_TABLE[166] = 0xd52c;
    _CRC16_TABLE[167] = 0xc50d;
    _CRC16_TABLE[168] = 0x34e2;
    _CRC16_TABLE[169] = 0x24c3;
    _CRC16_TABLE[170] = 0x14a0;
    _CRC16_TABLE[171] = 0x0481;
    _CRC16_TABLE[172] = 0x7466;
    _CRC16_TABLE[173] = 0x6447;
    _CRC16_TABLE[174] = 0x5424;
    _CRC16_TABLE[175] = 0x4405;
    _CRC16_TABLE[176] = 0xa7db;
    _CRC16_TABLE[177] = 0xb7fa;
    _CRC16_TABLE[178] = 0x8799;
    _CRC16_TABLE[179] = 0x97b8;
    _CRC16_TABLE[180] = 0xe75f;
    _CRC16_TABLE[181] = 0xf77e;
    _CRC16_TABLE[182] = 0xc71d;
    _CRC16_TABLE[183] = 0xd73c;
    _CRC16_TABLE[184] = 0x26d3;
    _CRC16_TABLE[185] = 0x36f2;
    _CRC16_TABLE[186] = 0x0691;
    _CRC16_TABLE[187] = 0x16b0;
    _CRC16_TABLE[188] = 0x6657;
    _CRC16_TABLE[189] = 0x7676;
    _CRC16_TABLE[190] = 0x4615;
    _CRC16_TABLE[191] = 0x5634;
    _CRC16_TABLE[192] = 0xd94c;
    _CRC16_TABLE[193] = 0xc96d;
    _CRC16_TABLE[194] = 0xf90e;
    _CRC16_TABLE[195] = 0xe92f;
    _CRC16_TABLE[196] = 0x99c8;
    _CRC16_TABLE[197] = 0x89e9;
    _CRC16_TABLE[198] = 0xb98a;
    _CRC16_TABLE[199] = 0xa9ab;
    _CRC16_TABLE[200] = 0x5844;
    _CRC16_TABLE[201] = 0x4865;
    _CRC16_TABLE[202] = 0x7806;
    _CRC16_TABLE[203] = 0x6827;
    _CRC16_TABLE[204] = 0x18c0;
    _CRC16_TABLE[205] = 0x08e1;
    _CRC16_TABLE[206] = 0x3882;
    _CRC16_TABLE[207] = 0x28a3;
    _CRC16_TABLE[208] = 0xcb7d;
    _CRC16_TABLE[209] = 0xdb5c;
    _CRC16_TABLE[210] = 0xeb3f;
    _CRC16_TABLE[211] = 0xfb1e;
    _CRC16_TABLE[212] = 0x8bf9;
    _CRC16_TABLE[213] = 0x9bd8;
    _CRC16_TABLE[214] = 0xabbb;
    _CRC16_TABLE[215] = 0xbb9a;
    _CRC16_TABLE[216] = 0x4a75;
    _CRC16_TABLE[217] = 0x5a54;
    _CRC16_TABLE[218] = 0x6a37;
    _CRC16_TABLE[219] = 0x7a16;
    _CRC16_TABLE[220] = 0x0af1;
    _CRC16_TABLE[221] = 0x1ad0;
    _CRC16_TABLE[222] = 0x2ab3;
    _CRC16_TABLE[223] = 0x3a92;
    _CRC16_TABLE[224] = 0xfd2e;
    _CRC16_TABLE[225] = 0xed0f;
    _CRC16_TABLE[226] = 0xdd6c;
    _CRC16_TABLE[227] = 0xcd4d;
    _CRC16_TABLE[228] = 0xbdaa;
    _CRC16_TABLE[229] = 0xad8b;
    _CRC16_TABLE[230] = 0x9de8;
    _CRC16_TABLE[231] = 0x8dc9;
    _CRC16_TABLE[232] = 0x7c26;
    _CRC16_TABLE[233] = 0x6c07;
    _CRC16_TABLE[234] = 0x5c64;
    _CRC16_TABLE[235] = 0x4c45;
    _CRC16_TABLE[236] = 0x3ca2;
    _CRC16_TABLE[237] = 0x2c83;
    _CRC16_TABLE[238] = 0x1ce0;
    _CRC16_TABLE[239] = 0x0cc1;
    _CRC16_TABLE[240] = 0xef1f;
    _CRC16_TABLE[241] = 0xff3e;
    _CRC16_TABLE[242] = 0xcf5d;
    _CRC16_TABLE[243] = 0xdf7c;
    _CRC16_TABLE[244] = 0xaf9b;
    _CRC16_TABLE[245] = 0xbfba;
    _CRC16_TABLE[246] = 0x8fd9;
    _CRC16_TABLE[247] = 0x9ff8;
    _CRC16_TABLE[248] = 0x6e17;
    _CRC16_TABLE[249] = 0x7e36;
    _CRC16_TABLE[250] = 0x4e55;
    _CRC16_TABLE[251] = 0x5e74;
    _CRC16_TABLE[252] = 0x2e93;
    _CRC16_TABLE[253] = 0x3eb2;
    _CRC16_TABLE[254] = 0x0ed1;
    _CRC16_TABLE[255] = 0x1ef0;

    for(i = 0; i <= 255; i++)
        BYTE[sprintf("%c", i)] = i;
}

function crc16Notable(input, crc,len,i,byte,code) {
    crc = 0x0;
    len = split(input, buf, "");
    for(i = 1; i <= len; i++) {
        byte = BYTE[buf[i]];
        code = and(rshift(crc, 8), 0xFF);
        code = xor(code, and(byte, 0xFF));
        code = xor(code, rshift(code, 4));
        crc = and(lshift(crc, 8), 0xFFFF);
        crc = xor(crc, code);
        code = and(lshift(code, 5), 0xFFFF);
        crc = xor(crc, code);
        code = and(lshift(code, 7), 0xFFFF);
        crc = xor(crc, code);
    }
    return crc;
}

function crc16(input, crc,len,i,tbl_idx) {
    crc = _crc_initial;
    len = split(input, buf, "");
    for(i = 1; i <= len; i++) {
        tbl_idx = and(xor(rshift(crc, 8), BYTE[buf[i]]), 0xff);
        crc = and(xor(_CRC16_TABLE[tbl_idx], lshift(crc, 8)), _crc_cmpl);
    }
    return crc;
}

function crc32(input, len,i1,i2) {
    len=length(input)
    i1 = substr(input,1,len/2)
    i2 = substr(input,len/2+1,len)
    return 65536*crc16(i1)+crc16(i2)
}
function crc64(input, len,i1,i2) {
    len=length(input)
    i1 = substr(input,1,len/2)
    i2 = substr(input,len/2+1,len)
    return 65536*65536*crc32(i1)+crc32(i2)
}
